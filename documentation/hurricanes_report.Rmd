---
title: "Hurricane Femininity and Deaths"
author: "Sam Kinghorn"
date: "`r Sys.Date()`"
output: pdf_document
---

According to the paper published by Jung et al. (2014), hurricanes with female names are deadlier than ones with male names because people unconsciously think that it will be less dangerous. I will explore this claim through an EDA and model deaths based on femininity to see if there is any significance.

## EDA

First, I load the data and investigate the femininity of hurricanes. 62 hurricanes in this data set have female names and 30 have male names. The femininity score is skewed left with most observations having a relatively high score.

```{r message=FALSE, warning=FALSE}
library(rethinking)
library(tidyverse)
library(lme4)
```

```{r}
data("Hurricanes")
df = Hurricanes
```

```{r}
table(df$female)
summary(df$femininity)
```

\newpage

The next two graphs show that some female hurricanes have a high number of deaths compared to male hurricanes. It's difficult to say if this is significant since there are more than double the number of female hurricanes.

```{r}
ggplot(data=df, mapping = aes(x=femininity, y=deaths, color=female)) + geom_point()
```

\newpage

```{r}
ggplot(data=df, mapping = aes(x=factor(female), y=deaths)) + geom_boxplot()
```

\newpage

The next three graphs display the femininity in relation to damage and hurricane category. The first graph shows that low femininity has just as much damage as high femininity. The second graph reinforces this point through a boxplot. The third graph shows boxplots of femininity for hurricane categories. If female hurricanes were actually more dangerous, we might expect to see more male hurricanes in the first few categories and more female hurricanes in the last few. This doesn't appear to be the case.

```{r}
ggplot(data=df, mapping = aes(x=femininity, y=damage_norm, color=female)) + geom_point()
```

\newpage

```{r}
ggplot(data=df, mapping = aes(x=factor(female), y=damage_norm)) + geom_boxplot()
```

\newpage

```{r}
ggplot(data=df, mapping = aes(x=factor(category), y=femininity)) + geom_boxplot()
```

The EDA suggests that female hurricanes may result in more deaths but they don't appear to be more dangerous in terms of damage and category. This corroborates the paper by Jung et al. (2014), that people may perceive female hurricanes as less dangerous and not take necessary precautions, despite female hurricanes being just as dangerous as male hurricanes. Next, I will fit a model to determine if femininity is significant in explaining deaths.

\newpage

## Count Models

The response variable is the number of deaths, therefore we are modeling a count variable. Poisson regression is a popular method for modeling count data, but there is a restrictive assumption on the model: the mean and variance of the response variable are equal. This comes from the fact that the mean and variance of the Poisson distribution are equal. In the case of our data, the mean and variance are 20.65 and 1673.15, respectively.

```{r}
sprintf("mean = %1.2f, var = %1.2f", mean(df$deaths), var(df$deaths))
```

Since the variance is much larger than the mean, the count data is over-dispersed. When count data is over-dispersed or under-dispersed, negative binomial regression can be used. Negative binomial regression is a generalization of Poisson regression and doesn't have the assumption of equidispersion. Negative binomial regression has an extra parameter, $\theta$ that can accommodate over-dispersion. 

```{r}
table = data.frame(c('$\\lambda$', '$\\lambda$'), c('$\\lambda$', '$\\lambda + \\frac {\\lambda^2}{\\theta}$'))
  colnames(table) = c("Mean", "Variance")
  rownames(table) = c("Possion", "NB")
  
  kable(table, align = 'c', booktabs = TRUE) %>%
  kable_styling(font_size = 20)
```


I will use both models and compare the results. The covariates include femininity score, minimum pressure of the storm, and normalized estimated damage of the storm in dollars. Minimum pressure is a measure of storm strength where lower values indicate a stronger storm. The main research question is on the significance of femininity score, but the other variables will be included to account for their effects on deaths. 

## Poisson Regression

We can model deaths through poisson regression. The research hypothesis and conceptual model are:

### Hypothesis

The number of deaths increases with femininity.

### Model

$$deaths_i \sim Poisson(\mu_i)$$

$$log(\mu_i) = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i}$$ where $x_{1i}$ is the level of femininity, $x_{2i}$ is the minimum pressure measurement, and $x_{3i}$ is the normalized estimate of damages.

### Results

The R printout for the model results can be seen in Appendix section [PUT SECTION]. The printout shows all variables as highly significant, i.e. all variables have a p-value below $0.01$. This means femininity score offers some explanatory power for hurricane deaths. The coefficients can be interpreted through exponentiation

```{r include=FALSE}
model_pois = glm(deaths ~ femininity + min_pressure + damage_norm, family="poisson", data=df)
```

```{r}
exp(model_pois$coefficients)
```

For every unit increase in femininity score, there is an approximate $8\%$ increase in deaths.

\newpage
### Negative Binomial Regression

We can model deaths through negative binomial regression. The research hypothesis and conceptual model are the same as for poisson regression:

### Hypothesis

The number of deaths increases with femininity.

### Model

$$log(\mu_i) = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i}$$ where $x_{1i}$ is the level of femininity, $x_{2i}$ is the minimum pressure measurement, and $x_{3i}$ is the normalized estimate of damages.

### Results

The R printout for the model results can be seen in Appendix section [PUT SECTION]. The printout shows that normalized damage and minimum pressure are significant in explaining deaths, i.e. the variables have a p-value below $0.05$. The coefficient associated with femininity score isn't significant at any level, i.e. the p-value is above $0.10$. Thus, we fail to reject the null hypothesis that the coefficient of femininity score is 0. In other words, this model provides evidence that there is not an association between femininity score and hurricane deaths. The additional dispersion parameter, $\theta$, is estimated from the data and is shown in the output to be 0.717. The coefficients have the same interpretation as poisson regression.

```{r include=FALSE}
model_nb = glm.nb(deaths ~ femininity + min_pressure + damage_norm, data=df)
```

## Comparison

A likelihood ratio test is performed to determine which model is more appropriate.

```{r}
pchisq(2*(logLik(model_nb) - logLik(model_pois)), df=1, lower.tail=FALSE)
```

\newpage
## Model Fit



\newpage
## Conclusion

The final model uses femininity to predict death count since it performs better than an intercept only model. This model has a positive coefficient associated with femininity, suggesting higher scores of femininity result in more deaths. More concretely, for a unit increase in femininity, the estimated death count increases by a factor of about $e^{0.07}=1.072508$, or increases by $7\%$. This suggests that an increase of 1 in the femininity score of a hurricane's name is estimated to have 107 deaths instead of 100. This analysis lends credence to the hypotheses proposed by Jung et.al (2014), namely that female hurricanes are deadlier than male hurricanes.

\newpage
## Appendix

### Poisson Model

```{r}
model_pois = glm(deaths ~ femininity + min_pressure + damage_norm, family="poisson", data=df)
summary(model_pois)
```

### Negative Binomial Model

```{r}
model_nb = glm.nb(deaths ~ femininity + min_pressure + damage_norm, data=df)
summary(model_nb)
```

